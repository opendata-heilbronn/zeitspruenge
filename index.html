<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-locatecontrol/0.60.0/L.Control.Locate.min.css"/>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-locatecontrol/0.60.0/L.Control.Locate.min.js"
            charset="utf-8"></script>
    <title>Zeitsprünge</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Open Sans', sans-serif;
        }

        #map {
            width: 100vw;
            height: 100vh;
        }

        .control-top-right {
            position: absolute;
            right: 10px;
            top: 10px;
            z-index: 900;
        }

        .toggle-container {
            display: flex;
            border: 2px solid #BEBEBE;
            border-radius: 4px;
        }

        .toggle-button {
            padding: 6px 8px;
            background: #FFF;
            cursor: pointer;
        }

        .toggle-button.active {
            background: #FFB44E;
            border-right: 1px solid #BEBEBE;
        }
    </style>
</head>
<body>
<div class="control-top-right">
    <div class="toggle-container">
        <div class="toggle-button toggle-historic">historisch</div>
        <div class="toggle-button toggle-current active">aktuell</div>
    </div>
</div>

<div id="map"></div>

<script>
    var map = L.map('map').setView([49.14224635671938, 9.218666553497314], 16);

    var locations = {
        "type": "FeatureCollection",
        "features": [
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/allee",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Allee",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Allee",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,22208",
                    "Position Breitengrad": "49,14126"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.22208,
                        49.14126
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/bahnhof",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Bahnhof",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Bahnhofsgegend",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,20892",
                    "Position Breitengrad": "49,14252"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.20892,
                        49.14252
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/fleiner",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Fleinerstrasse",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Fleinerstrasse",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,21912",
                    "Position Breitengrad": "49,14084"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.21912,
                        49.14084
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/kilianskirche",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Kilianskirche",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Kilianskirche",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,21944",
                    "Position Breitengrad": "49,14171"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.21944,
                        49.14171
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/kiliansplatz",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Kiliansplatz",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Kiliansplatz",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,21977",
                    "Position Breitengrad": "49,14129"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.21977,
                        49.14129
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/marktplatz",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Marktplatz",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Marktplatz",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,21866",
                    "Position Breitengrad": "49,14225"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.21866,
                        49.14225
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/neckarufer",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Neckarufer",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Neckarufer",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,21463",
                    "Position Breitengrad": "49,14123"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.21463,
                        49.14123
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/kaiserstrasse",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Obere Kaiserstrasse",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel obere Kaiserstrasse",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,22113",
                    "Position Breitengrad": "49,14171"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.22113,
                        49.14171
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/sulmerstrasse",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Sülmerstrasse",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Sülmerstrasse",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,22075",
                    "Position Breitengrad": "49,14350"
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.22075,
                        49.1435
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/untere-kaiserstrasse",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Kaiserstrasse",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel untere Kaiserstrasse",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,21697",
                    "Position Breitengrad": "49,14221",
                    "fillColor": "#ff7800",
                    "radius" : 8
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.21697,
                        49.14221
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/stadtbad",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Stadtbad",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Stadtbad",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,22009",
                    "Position Breitengrad": "49,13924",
                    "fillColor": "#ff7800",
                    "radius" : 8
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.22009,
                        49.13924
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/karl-und-sascha-kaiser",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Karl und Sascha Kaiser",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Karl und Sascha Kaiser",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,22963",
                    "Position Breitengrad": "49,13477",
                    "fillColor": "#ff7800",
                    "radius" : 8
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.22963,
                        49.13477
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/victoria-wolff",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Victoria Wolf",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Victoria Wolf",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,22565",
                    "Position Breitengrad": "49,14157",
                    "fillColor": "#ff7800",
                    "radius" : 8
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.22565,
                        49.14157
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/realgymnasium",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Realgymnasium",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Realgymnasium",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,22685",
                    "Position Breitengrad": "49,13988",
                    "fillColor": "#ff7800",
                    "radius" : 8
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.22685,
                        49.13988
                    ]
                }
            },
            {
                "type": "Feature",
                "properties": {
                    "Anker": "http://heilbronn.apps-1and1.net/theater",
                    "Bild-URL": "",
                    "Bild-URL 2": "",
                    "Strasse": "Theater",
                    "Ort": "Heilbronn",
                    "Beschreibung": "Kapitel Theater",
                    "Blickrichtung": "",
                    "Position Laengengrad": "9,22332",
                    "Position Breitengrad": "49,14605",
                    "fillColor": "#ff7800",
                    "radius" : 8
                },
                "geometry": {
                    "type": "Point",
                    "coordinates": [
                        9.22332,
                        49.14605
                    ]
                }
            }
        ]
    };

    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
        '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
        'Imagery © <a href="http://mapbox.com">Mapbox</a> | &copy; Stadt Heilbronn; Vermessungs- und Katasteramt',
        id: 'mapbox.light'
    }).addTo(map);

    L.geoJSON([locations], {
        style: function (feature) {
            return feature.properties && feature.properties.style;
        },

        onEachFeature: function (feature, layer) {
            var popupContent = "<p style='font-size:16px'>" + feature.properties['Strasse'] + '</p>';
            layer.bindPopup(popupContent, {
                maxWidth: 600
            });
            layer.on('mouseover', function () {
                layer.openPopup();
            });
            layer.on('mouseout', function () {
                layer.closePopup();
            });
        },

        pointToLayer: function (feature, latlng) {
            var fillColor = feature.properties.fillColor ? feature.properties.fillColor :  "#ff7800";
            var radius = feature.properties.radius ? feature.properties.radius :  8;
            var marker = L.circleMarker(latlng, {
                radius: radius,
                fillColor: fillColor,
                color: "#000",
                weight: 1,
                opacity: 1,
                fillOpacity: 1
            });

            marker.on("click", function () {
                window.open(feature.properties['Anker'], '_parent');
            });

            return marker;
        }
    }).addTo(map);

    L.control.locate().addTo(map);

    var layer = L.tileLayer('https://api.tiles.mapbox.com/v4/codeforheilbronn.dugwyvmr/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        opacity: 0
    });
    layer.addTo(map);

    if(L.Browser.mobile) {
        map.dragging.disable();
    }

    var toggleCurrentButton = document.querySelector('.toggle-current');
    var toggleHistoricButton = document.querySelector('.toggle-historic');
    var showCurrent = function () {
        layer.setOpacity(0);
        toggleCurrentButton.classList.add('active');
        toggleHistoricButton.classList.remove('active');
    };
    var showHistoric = function () {
        layer.setOpacity(1);
        toggleCurrentButton.classList.remove('active');
        toggleHistoricButton.classList.add('active');
    };
    toggleCurrentButton.addEventListener('click', showCurrent);
    toggleHistoricButton.addEventListener('click', showHistoric);
</script>

</body>
</html>
